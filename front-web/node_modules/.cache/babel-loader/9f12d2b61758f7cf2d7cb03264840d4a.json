{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"C:/workspaces/ws-sds2/dsdeliver/front-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"C:/workspaces/ws-sds2/dsdeliver/front-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/workspaces/ws-sds2/dsdeliver/front-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import ProductsList from'./ProductsList';import StepsHeader from'./StepsHeader';import'./styles.css';import{useEffect,useState}from'react';import{fetchProducts,saveOrder}from'../api';import OrderLocation from'./OrderLocation';import OrderSummary from'./OrderSummary';import Footer from'../Footer';import{checkIsSelected}from'./helpers';import{toast}from'react-toastify';function Orders(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),selectedProducts=_useState4[0],setSelectedProducts=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),orderLocation=_useState6[0],setOrderLocation=_useState6[1];var totalPrice=selectedProducts.reduce(function(sum,item){return sum+item.price;},0);useEffect(function(){fetchProducts().then(function(response){return setProducts(response.data);}).catch(function(){toast.warning('Erro ao enviar pedido');});},[]);var handleSelectProduct=function handleSelectProduct(product){var isAlreadySelected=checkIsSelected(selectedProducts,product);if(isAlreadySelected){var selected=selectedProducts.filter(function(item){return item.id!==product.id;});setSelectedProducts(selected);}else{setSelectedProducts(function(previous){return[].concat(_toConsumableArray(previous),[product]);});}};var handleSubmit=function handleSubmit(){var productsIds=selectedProducts.map(function(_ref){var id=_ref.id;return{id:id};});var payload=_objectSpread(_objectSpread({},orderLocation),{},{products:productsIds});saveOrder(payload).then(function(response){toast.error(\"Pedido enviado com sucesso! N\\xBA \".concat(response.data.id));setSelectedProducts([]);}).catch(function(){toast.warning('Erro ao enviar pedido');});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"orders-container\",children:[/*#__PURE__*/_jsx(StepsHeader,{}),/*#__PURE__*/_jsx(ProductsList,{products:products,onSelectProduct:handleSelectProduct,selectedProducts:selectedProducts}),/*#__PURE__*/_jsx(OrderLocation,{onChangeLocation:function onChangeLocation(location){return setOrderLocation(location);}}),/*#__PURE__*/_jsx(OrderSummary,{amount:selectedProducts.length,totalPrice:totalPrice,onSubmit:handleSubmit})]}),/*#__PURE__*/_jsx(Footer,{})]});}export default Orders;","map":{"version":3,"sources":["C:/workspaces/ws-sds2/dsdeliver/front-web/src/Orders/index.tsx"],"names":["ProductsList","StepsHeader","useEffect","useState","fetchProducts","saveOrder","OrderLocation","OrderSummary","Footer","checkIsSelected","toast","Orders","products","setProducts","selectedProducts","setSelectedProducts","orderLocation","setOrderLocation","totalPrice","reduce","sum","item","price","then","response","data","catch","warning","handleSelectProduct","product","isAlreadySelected","selected","filter","id","previous","handleSubmit","productsIds","map","payload","error","location","length"],"mappings":"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","sourcesContent":["import ProductsList from './ProductsList';\r\nimport StepsHeader from './StepsHeader';\r\nimport './styles.css';\r\nimport { useEffect, useState} from 'react';\r\nimport { OrderLocationData, Product } from './types';\r\nimport { fetchProducts, saveOrder } from '../api';\r\nimport OrderLocation from './OrderLocation';\r\nimport OrderSummary from './OrderSummary';\r\nimport Footer from '../Footer';\r\nimport { checkIsSelected } from './helpers';\r\nimport { toast } from 'react-toastify';\r\n\r\nfunction Orders() {\r\n    const[products, setProducts] = useState<Product[]>([]);\r\n    const[selectedProducts, setSelectedProducts] = useState<Product[]>([]);\r\n    const [orderLocation, setOrderLocation] = useState<OrderLocationData>();\r\n    const totalPrice= selectedProducts.reduce((sum, item) => {\r\n        return sum+item.price;\r\n    }, 0);\r\n    \r\n    useEffect(() => {\r\n        fetchProducts()\r\n        .then(response => setProducts(response.data))\r\n        .catch(() => {\r\n          toast.warning('Erro ao enviar pedido');\r\n        }) \r\n    }, []);\r\n\r\n    const handleSelectProduct = (product: Product) => {\r\n        const isAlreadySelected = checkIsSelected(selectedProducts, product);\r\n      \r\n        if (isAlreadySelected) {\r\n          const selected = selectedProducts.filter(item => item.id !== product.id);\r\n          setSelectedProducts(selected);\r\n        } else {\r\n          setSelectedProducts(previous => [...previous, product]);\r\n        }\r\n      }\r\n\r\n      const handleSubmit = () => {\r\n        const productsIds = selectedProducts.map(({ id }) => ({ id }));\r\n        const payload = {\r\n          ...orderLocation!,\r\n          products: productsIds\r\n        }\r\n      \r\n        saveOrder(payload)\r\n         .then((response) => {\r\n          toast.error(`Pedido enviado com sucesso! NÂº ${response.data.id}`);\r\n          setSelectedProducts([]);\r\n        })\r\n          .catch(() => {\r\n            toast.warning('Erro ao enviar pedido');\r\n          })\r\n      }\r\n\r\n    return(\r\n       <>\r\n       <div className=\"orders-container\">\r\n           <StepsHeader />\r\n           <ProductsList \r\n           products={products} \r\n           onSelectProduct={handleSelectProduct}\r\n           selectedProducts={selectedProducts}\r\n           />\r\n           <OrderLocation \r\n            onChangeLocation = {location => setOrderLocation(location)}\r\n           />\r\n           <OrderSummary \r\n            amount={selectedProducts.length} \r\n            totalPrice={totalPrice}\r\n            onSubmit={handleSubmit}\r\n            />\r\n       </div>\r\n        <Footer />\r\n       </>\r\n       \r\n    )\r\n}\r\nexport default Orders;"]},"metadata":{},"sourceType":"module"}